<!doctype html><html lang="ko"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>오늘 무슨 운동 하지?</title>
<style>
body{background:#111;color:#fff;font-family:sans-serif;margin:0;text-align:center}
header{display:flex;justify-content:space-between;align-items:center;padding:10px 16px}
header a{color:#7cfc00;text-decoration:none}
canvas{width:90vw;max-width:520px;margin-top:16px;border-radius:50%;background:#222}
.pin{width:0;height:0;border-left:20px solid transparent;border-right:20px solid transparent;border-bottom:30px solid yellow;margin:8px auto 0}
button{margin:8px;padding:10px 16px;border:none;border-radius:10px;background:#7cfc00;color:#000;font-weight:700}
dialog{border:none;border-radius:12px;padding:16px;background:#222;color:#fff;max-width:92vw}
input{width:92%;max-width:520px;margin:4px 0;padding:8px;border-radius:8px;border:none}
</style></head><body>
<header><a href="index.html">🏠 메인</a><h3>오늘 무슨 운동 하지?</h3><button id="btnAdmin">⚙️ Admin</button></header>
<div class="pin"></div><canvas id="wheel" width="520" height="520"></canvas><br><button id="spin">돌리기</button>
<dialog id="admin"><h3>Admin 메뉴</h3><div id="list"></div>
<button id="exp">내보내기</button><input id="impFile" type="file" accept="application/json" style="display:none"><button id="imp">가져오기</button>
<button onclick="admin.close()">닫기</button></dialog>
<script>
const KEY='dtm.routines.v8_1', MAX=100;
let routines=load(); function load(){try{let raw=localStorage.getItem(KEY);if(!raw)return init();let arr=JSON.parse(raw);if(!Array.isArray(arr))return init();let out=new Array(MAX).fill('');for(let i=0;i<MAX;i++)out[i]=arr[i]||'';return out;}catch(e){return init();}}
function save(){localStorage.setItem(KEY,JSON.stringify(routines));}
function init(){let seed=['풀업 10개','푸쉬업 30개','딥스 20개','버피 30개'];let arr=new Array(MAX).fill('');for(let i=0;i<seed.length;i++)arr[i]=seed[i];return arr;}
const cv=document.getElementById('wheel'), ctx=cv.getContext('2d'); let ang=0, vel=0, spin=false; const cols=['#e63946','#f1fa8c','#06d6a0','#118ab2'];
function draw(){ctx.clearRect(0,0,cv.width,cv.height);const R=cv.width/2;ctx.save();ctx.translate(R,R);ctx.rotate(ang);for(let i=0;i<4;i++){let a0=i*Math.PI/2,a1=a0+Math.PI/2;ctx.beginPath();ctx.moveTo(0,0);ctx.arc(0,0,R,a0,a1);ctx.fillStyle=cols[i];ctx.fill();ctx.save();ctx.rotate(a0+Math.PI/4);ctx.translate(R*0.62,0);ctx.rotate(Math.PI/2);ctx.fillStyle='#000';ctx.font='bold 72px system-ui';ctx.textAlign='center';ctx.textBaseline='middle';ctx.fillText('?',0,0);ctx.restore();}ctx.restore();}
draw();
document.getElementById('spin').onclick=()=>{if(spin)return;spin=true;vel=28+Math.random()*10;const t0=performance.now();(function step(t){let dt=(t-(step.lt||t))/1000;step.lt=t;ang+=vel*dt;vel*=0.965;draw();if(vel<0.12||(t-t0)>5000){spin=false;let list=routines.filter(x=>x&&x.trim());alert(list.length?('오늘의 루틴: '+list[Math.floor(Math.random()*list.length)]):'루틴 없음');return;}requestAnimationFrame(step);})(t0);};
const admin=document.getElementById('admin');document.getElementById('btnAdmin').onclick=()=>{render();admin.showModal();};
function render(){let L=document.getElementById('list');L.innerHTML='';for(let i=0;i<MAX;i++){let inp=document.createElement('input');inp.value=routines[i];inp.placeholder='루틴 '+(i+1);inp.oninput=()=>{routines[i]=inp.value;save();};L.appendChild(inp);}}
document.getElementById('exp').onclick=()=>{let a=document.createElement('a');a.href=URL.createObjectURL(new Blob([JSON.stringify(routines)],{type:'application/json'}));a.download='routines.json';a.click();};
document.getElementById('imp').onclick=()=>impFile.click();
impFile.onchange=async e=>{let f=e.target.files[0];if(!f)return;try{let arr=JSON.parse(await f.text());if(Array.isArray(arr)){routines=new Array(MAX).fill('');for(let i=0;i<MAX;i++)routines[i]=arr[i]||'';save();render();}}catch(_){alert('JSON 형식 오류');}};
</script></body></html>